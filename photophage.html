<!DOCTYPE html>  
<html lang="th">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>LINE LIFF Form</title>  
    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script> <!-- Include LINE LIFF SDK -->  
    <style>  
        body {  
            font-family: Arial, sans-serif;  
            text-align: center;  
            padding: 20px;  
            background-color: #f4f4f4; /* สีพื้นหลัง */  
        }  
        h1 {  
            font-size: 2.5em; /* ขนาดข้อความใหญ่ */  
            color: #333; /* สีข้อความ */  
            margin-bottom: 20px; /* ช่องว่างด้านล่าง */  
        }  
        input[type="text"], input[type="file"] {  
            width: 80%; /* ความกว้างของช่องกรอกข้อมูล */  
            padding: 10px; /* ช่องว่างภายใน */  
            margin: 10px 0; /* ช่องว่างด้านบนและล่าง */  
            border: 1px solid #ccc; /* เส้นขอบ */  
            border-radius: 5px; /* มุมโค้ง */  
            font-size: 1em; /* ขนาดข้อความ */  
        }  
        button {  
            padding: 10px 20px; /* ช่องว่างภายในปุ่ม */  
            background-color: #4CAF50; /* สีพื้นหลังปุ่ม */  
            color: white; /* สีข้อความในปุ่ม */  
            border: none; /* ไม่มีเส้นขอบ */  
            border-radius: 5px; /* มุมโค้ง */  
            cursor: pointer; /* เปลี่ยนเคอร์เซอร์เมื่อชี้ที่ปุ่ม */  
            font-size: 1.2em; /* ขนาดข้อความในปุ่ม */  
            margin-top: 20px; /* ช่องว่างด้านบน */  
        }  
        button:hover {  
            background-color: #45a049; /* สีพื้นหลังเมื่อชี้ที่ปุ่ม */  
        }  
        .message {  
            margin-top: 20px; /* ช่องว่างด้านบน */  
            font-size: 1.2em; /* ขนาดข้อความ */  
            color: #333; /* สีข้อความ */  
        }  
    </style>  
</head>  
<body>  
    <h1>แบบฟอร์มบันทึกข้อมูล</h1>  
    <input type="text" id="orderNumber" placeholder="กรอกเลขออเดอร์" required>  
    <input type="file" id="imageUpload" accept="image/*" required>  
    <button onclick="submitForm()">บันทึกข้อมูล</button>  
    <div class="message" id="message"></div>  

    <script>  
        // Initialize LIFF  
        liff.init({ liffId: '2006738214-149nvm0m' }, () => {  
            console.log('LIFF initialized');  
        }, err => {  
            console.error('LIFF initialization failed', err);  
        });  

        function submitForm() {  
            const orderNumber = document.getElementById('orderNumber').value;  
            const imageUpload = document.getElementById('imageUpload').files[0];  

            if (!orderNumber || !imageUpload) {  
                alert('กรุณากรอกเลขออเดอร์และอัพโหลดรูปภาพ');  
                return;  
            }  

            const reader = new FileReader();  
            reader.onloadend = function() {  
                const imageUrl = reader.result;  

                document.getElementById('message').innerText = 'รอสักครู่ กำลังบันทึกข้อมูล...';  

                google.script.run.withSuccessHandler(function(response) {  
                    document.getElementById('message').innerText = 'บันทึกข้อมูลเรียบร้อย';  
                    setTimeout(() => {  
                        window.close();  
                    }, 2000);  
                }).saveImage(orderNumber, imageUrl);  
            }  
            reader.readAsDataURL(imageUpload);  
        }  
    </script>  
</body>  
</html>
